dependencies:
  # Release version
  - name: "repo release version"
    version: 3.2.0
    refPaths:
    - path: cloudbuild.yaml
      match: v((([0-9]+)\.([0-9]+)\.([0-9]+)(?:-([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?)(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?)-([0-9]+)
    - path: Makefile-kpromo
      match: IMAGE_VERSION\ \?=\ v((([0-9]+)\.([0-9]+)\.([0-9]+)(?:-([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?)(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?)-([0-9]+)
    - path: VERSION

  # repo infra
  - name: "repo-infra"
    version: 0.2.2
    refPaths:
    - path: hack/verify-boilerplate.sh
      match: VERSION=v(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?

  # zeitgeist
  - name: "zeitgeist"
    version: 0.3.0
    refPaths:
    - path: hack/verify-dependencies.sh
      match: VERSION=v(?P<major>0|[1-9]\d*)\.(?P<minor>0|[1-9]\d*)\.(?P<patch>0|[1-9]\d*)(?:-(?P<prerelease>(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+(?P<buildmetadata>[0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?

  - name: "Debian: codename (default)"
    version: buster
    refPaths:
    # Must match distroless Debian version as well
    - path: cloudbuild.yaml
      match: "OS_CODENAME: '(bullseye|buster)'"
    - path: Dockerfile
      match: FROM golang:\d+.\d+(alpha|beta|rc)?\.?(\d+)-(bullseye|buster)
    - path: Makefile-kpromo
      match: OS_CODENAME\ \?=\ (bullseye|buster)

  # golangci-lint
  - name: "golangci-lint"
    version: 1.42.1
    refPaths:
    - path: hack/verify-golangci-lint.sh
      match: VERSION=v(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?

  # Golang
  - name: "golang"
    version: 1.17
    refPaths:
    - path: cloudbuild.yaml
      match: "_GO_VERSION: '\\d+.\\d+(alpha|beta|rc)?\\.?(\\d+)?'"
    - path: Makefile-kpromo
      match: GO_VERSION\ \?=\ \d+.\d+(alpha|beta|rc)?\.?(\d+)?
    - path: Dockerfile
      match: FROM golang:\d+.\d+(alpha|beta|rc)?\.?(\d+)-(bullseye|buster) AS base

  # Golang pre-releases are denoted as `1.y<pre-release stage>.z`
  # Example: go1.17rc1
  #
  # This entry is a stub of the major version to allow dependency checks to
  # pass when building Kubernetes using a pre-release of Golang.
  - name: "golang: 1.<major>"
    version: 1.17
    refPaths:
    - path: Dockerfile
      match: FROM golang:\d+.\d+(alpha|beta|rc)?\.?(\d+)-(bullseye|buster)

  - name: "golang: go.mod"
    version: 1.17
    refPaths:
    - path: go.mod
      match: go \d+.\d+

  - name: "k8s.gcr.io/artifact-promoter/kpromo"
    version: v3.2.0-1
    refPaths:
    - path: cloudbuild.yaml
      match: v((([0-9]+)\.([0-9]+)\.([0-9]+)(?:-([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?)(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?)-([0-9]+)
    - path: Makefile-kpromo
      match: IMAGE_VERSION\ \?=\ v((([0-9]+)\.([0-9]+)\.([0-9]+)(?:-([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?)(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?)-([0-9]+)
